@using Digital_Library.Core.Models
@using Microsoft.AspNetCore.Identity

@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager

<style>
 /* Normal state */
 .logout-item {
  color: #dc3545; /* Bootstrap danger color for text */
 }

  /* Hover state */
  .logout-item:hover {
   background-color: #dc3545; /* Red background */
   color: #fff; /* White text on hover */
  }
</style>

<li class="nav-item dropdown pe-3">
 <a href="#" class="nav-link dropdown-toggle" id="userDropdown" role="button"
    data-bs-toggle="dropdown" aria-expanded="false">
  <svg class="user">
   <use xlink:href="#user"></use>
  </svg>
 </a>

 @if (SignInManager.IsSignedIn(User))
 {
  var user = await UserManager.GetUserAsync(User);
  var roles = await UserManager.GetRolesAsync(user);

  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
   <li>
    <a class="dropdown-item d-flex align-items-center" href="/Account/Profile">
     <i class="bi bi-person-circle me-2"></i> My Profile
    </a>
   </li>
   <li>
    <a class="dropdown-item d-flex align-items-center" href="/Orders/MyOrders">
     <i class="bi bi-bag-check me-2"></i> My Orders
    </a>
   </li>

   @if (roles.Contains(Digital_Library.Core.Constant.Roles.Vendor))
   {
    <li>
     <a class="dropdown-item d-flex align-items-center" asp-controller="Vendor" asp-action="Dashboard">
      <i class="bi bi-journal-bookmark me-2"></i> My Library
     </a>
    </li>

    <li>
     <a class="dropdown-item d-flex align-items-center" asp-controller="Book" asp-action="Index">
      <i class="bi bi-book me-2"></i> My Books
     </a>
    </li>
   }
   else
   {
    <li>
     <a class="dropdown-item d-flex align-items-center" asp-controller="Vendor" asp-action="BecomeVendor">
      <i class="bi bi-shop me-2"></i> Become Vendor
     </a>
    </li>
   }


   <li><hr class="dropdown-divider" /></li>
   <li>
    <form asp-area="" asp-controller="Auth" asp-action="Logout" method="post" class="m-0">
     <button type="submit" class="dropdown-item d-flex align-items-center logout-item">
      <i class="bi bi-box-arrow-right me-2"></i> Logout
     </button>
    </form>
   </li>
  </ul>
 }
 else
 {
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
   <li>
    <a class="dropdown-item d-flex align-items-center" asp-controller="Auth" asp-action="Login">
     <i class="bi bi-box-arrow-in-right me-2"></i> Login
    </a>
   </li>
   <li>
    <a class="dropdown-item d-flex align-items-center" asp-controller="Auth" asp-action="Register">
     <i class="bi bi-person-plus me-2"></i> Register
    </a>
   </li>
  </ul>
 }
</li>
